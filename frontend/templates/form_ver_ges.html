<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>FORMULARIO DE CONSTANCIA INFORMACIÓN AL PACIENTE GES</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <form id="form_paciente" action="/notificaciongespaciente" method="post">
        <div class="container-fluid" >
            <div class="row">
                <div class="col-md-12 centrado">
                    <img src="{{ url_for('static', filename='img/channels-15_bg_header.png') }}" alt="img_header"><br>
                </div>
            </div>
        </div>
        <div class="container-fluid" >
            <div class="row">
                <div class="col-md-12">
                    <br>
                    <h2>FORMULARIO DE CONSTANCIA INFORMACIÓN AL PACIENTE GES<br>(Artículo 24°, Ley 19.966)</h2>
                </div>
            </div>
        </div>
        <br>

        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <hr>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <h3>Datos del prestador</h3>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-md-12">
                    <label for="nombre_establecimiento">Nombre de la Institución (Hospital, Clínica, Consultorio, etc.)</label>
                    <input type="text" id="nombre_establecimiento" name="nombre_establecimiento" value="{{data.nombre_establecimiento}}" class="form-control" readonly>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-md-6">
                    <label for="direccion_establecimiento">Dirección</label>
                    <input type="text" id="direccion_establecimiento" name="direccion_establecimiento" value="{{data.direccion_establecimiento}}" class="form-control" readonly>
                </div>
                <div class="col-md-6">
                    <label for="ciudad_establecimiento">Ciudad</label>
                    <input type="text" id="ciudad_establecimiento" name="ciudad_establecimiento" value="{{data.ciudad_establecimiento}}" class="form-control" readonly>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-md-6">
                    <label for="nombre_notificador">Nombre persona que notifica</label>
                    <input type="text" id="nombre_notificador" name="nombre_notificador" value="{{data.nombre_notificador}}" class="form-control" readonly>
                </div>
                <div class="col-md-6">
                    <label for="rut_notificador">RUT persona que notifica en representación del Prestador de Salud</label>
                    <input type="text" id="rut_notificador" name="rut_notificador" value="{{data.rut_notificador}}" class="form-control" readonly>
                </div>
            </div>
        </div>
        <br>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <hr>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <h3>Antecedentes del Paciente</h3>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-md-6">
                    <label for="nombre_paciente">Nombre completo</label>
                    <input type="text" id="nombre_paciente" name="nombre_paciente" class="form-control" value="{{ data.nombre_paciente }}" readonly>

                </div>
                <div class="col-md-4">
                    <label for="rut_paciente">Rut</label>
                    <input type="text" id="rut_paciente" name="rut_paciente" class="form-control" value="{{ data.rut_paciente }}" readonly>
                </div>
                <div class="col-md-2">
                    <label for="aseguradora_paciente">Aseguradora</label>
                    <input type="text" id="aseguradora_paciente" name="aseguradora_paciente" value="{{data.aseguradora_paciente}}" class="form-control" readonly>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-md-6">
                    <label for="direccion_paciente">Dirección</label>
                    <input type="text" id="direccion_paciente" name="direccion_paciente" class="form-control" value="{{data.direccion_paciente}}" readonly>
                </div>
                <div class="col-md-6">
                    <label for="comuna_paciente">Comuna / Región</label>
                    <input type="text" id="comuna_paciente" name="comuna_paciente" class="form-control" value="{{data.comuna_paciente}} / {{data.region_paciente}}" readonly>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-md-6">
                    <label for="telefono_fijo_paciente">Teléfono de contacto:</label>
                    <input type="text" id="telefono_fijo_paciente" name="telefono_fijo_paciente" class="form-control" value="Fijo: {{data.telefono_fijo_paciente}} | Celular: {{data.celular_paciente}}" readonly>
                </div>
                <div class="col-md-6">
                    <label for="email_paciente">Correo electrónico (E-mail)</label>
                    <input type="email" id="email_paciente" name="email_paciente" value="{{ data.email_paciente }}" class="form-control" readonly>
                </div>
            </div>
            <br>
        </div>
        <br>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-8">
                    <hr>
                </div>
                <div class="col-md-4">
                    <hr>
                </div>
            </div>
            <div class="row">
                <div class="col-md-8">
                    <h3>Información médica</h3>
                </div>
                <div class="col-md-4">
                    <h3>Notificación</h3>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-md-8">
                    <label for="diagnostico_ges">Confirmación diagnóstica GES (Problema de Salud - Patología)</label>
                    <input type="text" id="diagnostico_ges" name="diagnostico_ges" class="form-control" value="{{ data.diagnostico_ges }}" readonly /> <br>
                    <input type="checkbox" id="tipo" name="tipo" checked disabled />
                    <label for="tipo">{{data.tipo}}</label>
                </div>
                <div class="col-md-4">
                    <label for="fechahora_notificacion">Fecha y hora</label>
                    <input type="text" id="fechahora_notificacion" name="fechahora_notificacion" class="form-control" value="{{data.fechahora_notificacion}}" readonly>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <hr>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <h3>CONSTANCIA</h3>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-md-4">
                    Declaro que, con esta fecha y hora, he tomado conocimiento que tengo derecho a acceder a las “Garantías Explícitas en Salud”, GES, siempre que la atención sea otorgada en la “Red de Prestadores” que me corresponde según Fonasa o la Isapre, a la que me encuentro adscrito.
                </div>
                <div class="col-md-4 centrado">
                    <img src="{{ url_for('static', filename='img/firmaelectronica-min.png') }}" alt="Firma notificador" height="60px"><br>
                    Firmado electronicamente {{data.nombre_notificador}}<br>
                    <b>Informé diagnóstico GES</b> <br>
                     Firma de la persona que notifica
                </div>
                <div class="col-md-4 centrado">
                    <img src="{{ data.firma_paciente }}" alt="Firma paciente" height="75px"><br>
                    <b>Tomé conocimiento</b><br>
                    Firma o huella digital del paciente o representante
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-md-12">
                    <b>IMPORTANTE:</b> El paciente debe tener presente que si no se cumplen las garantías, puede reclamar ante el Fonasa o la Isapre, según corresponda. Si la respuesta no es satisfactoria, puede recurrir en segunda instancia a la Superintendencia de Salud.
                </div>
            </div>
            
        </div>
        <br>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <hr>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 centrado">
                    En caso que la persona que “tomó conocimiento” no sea el paciente, identificar los siguientes datos:
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 centrado">
                    <h3>Antecedentes del representante</h3>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <label for="nombre_representante">Nombre completo</label>
                    <input type="text" id="nombre_representante" name="nombre_representante" class="form-control" value="{{data.nombre_representante}}" readonly>
                </div>
                <div class="col-md-6">
                    <label for="rut_representante">RUT</label>
                    <input type="text" id="rut_representante" name="rut_representante" class="form-control" value="{{data.rut_representante}}" readonly>
                </div>
            </div>
            <div class="row">
                <div class="col-md-3">
                    <label for="telefono_representante">Teléfono de contacto: </label>
                    <input type="text" id="telefono_representante" name="telefono_representante" class="form-control" value="Fijo: {{data.telefono_representante}} | Celular: {{data.celular_representante}} " readonly>
                </div>
                <div class="col-md-3">
                    <label for="email_representante">Correo electrónico (E-mail)</label>
                    <input type="email" id="email_representante" name="email_representante" class="form-control" value="{{data.email_representante}}" readonly>
                </div>
            </div>
            <br>
        </div>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12 centrado">
                    <input type="button" id="descargar" value="Descargar" class="btn btn-primary" style="display: none;"> 
                    <input type="button" id="imprimir" value="Imprimir" class="btn btn-primary">      
                    <input type="number" id="id" name="id" class="form-control" value="{{ data.id }}" style="display: none;">
                </div>
            </div>
            <div class="col-md-1"></div>

        </div>
    </form>
    <script>
        document.getElementById('descargar').addEventListener('click', function() {
            fetch('/vernotificacionges/pdf/{{ data.id }}', {
                method: 'GET',
            })
            .then(response => response.blob())
            .then(blob => {
                var url = window.URL.createObjectURL(blob);
                var a = document.createElement('a');
                a.href = url;
                a.download = 'output.pdf';
                document.body.appendChild(a); // we need to append the element to the dom -> otherwise it will not work in firefox
                a.click();    
                a.remove();  //afterwards we remove the element again         
            });
        });
        document.getElementById('imprimir').addEventListener('click', function() {
            var imprimirBtn = document.getElementById('imprimir');
            imprimirBtn.classList.add('hide'); // Agrega la clase 'hide' para ocultar el botón
            window.print();
            imprimirBtn.classList.remove('hide'); // Elimina la clase 'hide' para mostrar el botón nuevamente
    });

    </script>
</body>
</html>